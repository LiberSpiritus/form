
<!DOCTYPE html>
<html class="surveyBg">
<head>
<title>구글 폼 (Validation)</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link type="text/css" rel="stylesheet" href="css/survey.css">
</head>
<body>
	<div class="surveyParent">
		<form class="form" id="form">
			<div class="surveyHeader">
				<div class="surveyHeaderBg"></div>
				<div class="serveyHeaderBody">
					<div class="surveyTit">
						클린선거시민행동
					</div>
					<div class="surveyDescription">
						3.9 대선 (부정감시를 위한) 투개표 참관인 모집
					</div>	
				</div>
				<div class="surveyBorder"></div>	
				<div class="surveyRequired">* 필수항목</div>	
			</div>
			<div class="surveyItemList">
				<div class="surveyItem">
					<div class="surveyItemRoot">
						<div class="surveyItemHeader Required">
							이름
						</div>
						<div class="surveyItemInputEl">
							<div class="surveyItemInputArea">
								<input type="text" class="surveyInput" id="nameInput" placeholder="내 답변">
							</div>
							<div class="surveyBorder"></div>	
						</div>
						<span class="surveyRequiredText"><span>필수 질문입니다.</span></span>
					</div>
				</div>
			</div>
			<div class="surveyItemList">
				<div class="surveyItem">
					<div class="surveyItemRoot">
						<div class="surveyItemHeader Required">
							전화번호
						</div>
						<div class="surveyItemInputEl">
							<div class="surveyItemInputArea">
								<input type="text" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');" maxlength="11" pattern=".{11,11}" required title="11자리로 입력해주세요" class="surveyInput" id="phoneInput" placeholder="내 답변">
							</div>
							<div class="surveyBorder"></div>	
						</div>
						<span class="surveyRequiredText"><span>필수 질문입니다.</span></span>
					</div>
				</div>
			</div>
			<div class="surveyItemList">
				<div class="surveyItem">
					<div class="surveyItemRoot">
						<div class="surveyItemHeader Required">
							본인의 주소
						</div>
						<div class="surveyItemInputEl address">
							<div class="surveyItemInputArea">
								<input type="text" class="surveyInput" id="addressInput" placeholder="내 답변">
							</div>
							<div class="surveyBorder"></div>	
						</div>
						<span class="surveyRequiredText"><span>필수 질문입니다.</span></span>
					</div>
				</div>
			</div>
			<div class="surveyItemList">
				<div class="surveyItem">
					<div class="surveyItemRoot">
						<div class="surveyItemHeader Required">
							성별
						</div>
						<div class="surveyItemInputEl">
							<label for="male"><input type="radio" name="r1" id="male" /><span>남</span></label>
							<label for="female"><input type="radio" name="r1" id="female" /><span>여</span></label>
						</div>
						<span class="surveyRequiredText"><span>필수 질문입니다.</span></span>
					</div>
				</div>
			</div>
			<div class="surveyItemList">
				<div class="surveyItem">
					<div class="surveyItemRoot">
						<div class="surveyItemHeader Required">
							생년월일 (8자리 예: 1951년 7월 19일 경우, 19510719)
						</div>
						<div class="surveyItemInputEl">
							<div class="surveyItemInputArea">
								<input type="text" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');" maxlength="8" pattern=".{8,8}" required title="8자리로 입력해주세요" class="surveyInput" id="birthInput" placeholder="내 답변">
							</div>
							<div class="surveyBorder"></div>	
						</div>
						<span class="surveyRequiredText"><span>필수 질문입니다.</span></span>
					</div>
				</div>
			</div>			
			<div class="surveyItemList">
				<div class="surveyItem">
					<div class="surveyItemRoot">
						<div class="surveyItemHeader">
							(사전투표 참관인 선택은 복수로 선택 가능하고 적극참여 부탁 드립니다.)
						</div>
						<div class="surveyItemInputEl">
							<label for="vote1"><input type="checkbox" name="chk1" id="vote1" /><span>3월 4일 (05:30)</span></label>
							<label for="vote2"><input type="checkbox" name="chk1" id="vote2" /><span>3월 4일 (11:30)</span></label>
						</div>
						<span class="surveyRequiredText"><span>필수 질문입니다.</span></span>
					</div>
				</div>
			</div>		
			<div class="surveyItemList">
				<div class="surveyItem">
					<div class="surveyItemRoot">
						<div class="surveyItemHeader">
							(사전투표 참관인 선택은 복수로 선택 가능하고 적극참여 부탁 드립니다.)
						</div>
						<div class="surveyItemInputEl">
							<label for="vote3"><input type="checkbox" name="chk2" id="vote3" /><span>3월 5일 (05:30)</span></label>
							<label for="vote4"><input type="checkbox" name="chk2" id="vote4" /><span>3월 5일 (11:30)</span></label>
						</div>
						<span class="surveyRequiredText"><span>필수 질문입니다.</span></span>
					</div>
				</div>
			</div>	
			<div class="surveyItemList">
				<div class="surveyItem">
					<div class="surveyItemRoot">
						<div class="surveyItemHeader">
							(사전투표 참관인 선택은 복수로 선택 가능하고 적극참여 부탁 드립니다.)
						</div>
						<div class="surveyItemInputEl">
							<label for="vote5"><input type="checkbox" name="chk3" id="vote5" /><span>3월 9일 (05:30)</span></label>
							<label for="vote6"><input type="checkbox" name="chk3" id="vote6" /><span>3월 9일 (11:30)</span></label>
						</div>
						<span class="surveyRequiredText"><span>필수 질문입니다.</span></span>
					</div>
				</div>
			</div>	
			<div class="surveyItemList">
				<div class="surveyItem">
					<div class="surveyItemRoot">
						<div class="surveyItemHeader">
							개표 (개표참관 하실분은 본투표 참관을 반드시 오전 05:30으로 참관합니다)
						</div>
						<div class="surveyItemInputEl">
							<label for="vote7"><input type="radio" name="rdo2" id="vote7" /><span>3월 9일 저녁 (17:30)</span></label>
							<label for="vote8"><input type="radio" name="rdo2" id="vote8" /><span>개표 방청객 참관 (17:30)</span></label>
						</div>
						<span class="surveyRequiredText"><span>필수 질문입니다.</span></span>
					</div>
				</div>
			</div>		
			<button class="surveySubmit">제출</button>		
		</form>
	</div>	
</body>
<script>
// 유효성 체크 하기위한 스크립트
const form = document.getElementById('form');
const nameInput = document.querySelector('#nameInput');
const phoneInput = document.getElementById('phoneInput');
const addressInput = document.getElementById('addressInput');
const maleInput = document.getElementById('male');
const femaleInput = document.getElementById('female');
const birthInput = document.getElementById('birthInput');

//button Default Type값이 submit 이므로
//button을 클릭했을시 발생함.
/* form.addEventListener('submit',(e) => {
	e.preventDefault();	
 	checkInputs();
}); */

form.addEventListener('submit', function (e){
	e.preventDefault();	
 	checkInputs();	
});


// Input 값 유무 검사후 이상 없으면 submit 처리.
function checkInputs(){
  const nameValue = nameInput.value.trim();
  const phoneValue = phoneInput.value.trim();
  const addressValue = addressInput.value.trim();
  const birthValue = birthInput.value.trim();
  
  if(nameValue === ''){
    setErrorFor(nameInput, '이름을 다시 입력하세요');
    return false;
  } else {
    setSuccessFor(nameInput);
  }  
  
  if(phoneValue === ''){
    setErrorFor(phoneInput, '전화번호를 다시 입력하세요');
    return false;
  } else {
    setSuccessFor(phoneInput);
  }    
  
  if(addressValue === ''){
    setErrorFor(addressInput, '주소를 다시 입력하세요');
    return false;
  } else {
    setSuccessFor(addressInput);
  }  
  
  // validation for Gender
  if(maleInput.checked==false && femaleInput.checked==false){
  	setErrorFor(maleInput, '성별을 선택하세요');
  	return false;
  } else {
	  setSuccessFor(maleInput);
  }  
  
  if(birthValue === ''){
    setErrorFor(birthInput, '생년월일을 다시 입력하세요');
    return false;
  } else {
    setSuccessFor(birthInput);
  }    
	  
  form.submit();
  
}

function setErrorFor(input, message){
  const rootEl = input.parentElement.parentElement.parentElement; // .surveyItemInputEl
  const requiredToggle = rootEl.querySelector('.surveyRequiredText'); 
  const requiredText = rootEl.querySelector('.surveyRequiredText span');
  
  rootEl.scrollIntoView();
  
  // 에러 메시지 넣기
  requiredText.innerText = message;
  
  // error class 추가
  requiredToggle.className = 'surveyRequiredText error';
}

function setSuccessFor(input){
	const rootEl = input.parentElement.parentElement.parentElement; // .surveyItemInputEl
	const requiredToggle = rootEl.querySelector('.surveyRequiredText');
	requiredToggle.className = 'surveyRequiredText';
}
</script>
</html>

